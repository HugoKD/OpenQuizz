{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>OpenQuizz - UserHome</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{% static 'quizz/css/interfaceUser.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/717f408a62.js" crossorigin="anonymous"></script>
</head>
<body>

    <div class="main">

        <h1>-{{ question }}-</h1>

        <img src="../../../media/{{ image }}" alt="image_quizz">
        <div class="timer"><h2>{{ timer }}</h2></div>
        <div class="questions">
            <div class="bloc">
                <button type="submit" formmethod="post" id="bouton1" name="bouton1" form="myForm" action="reponse1"><h2>{{ reponse1 }}</h2></button>
                <button type="submit" id="bouton2" name="bouton2" form="myForm" action="reponse2"><h2>{{ reponse2 }}</h2></button>
            </div>
            <div class="bloc" id="bloc">
                <button class="question_bas" type="submit" id="bouton3" name="bouton3" form="myForm"><h2>{{ reponse3 }}</h2></button>
                <button class="question_bas" type="submit" id="bouton4" name="bouton4" form="myForm"><h2>{{ reponse4 }}</h2></button>
            </div>
        </div>
        <div class="id_quizz"><h3>{{ id_quizz }}</h3></div>{% csrf_token %} <!--sert juste a donner les info aux js-->
        <div class="num_question"><h3>{{ num_question }}</h3></div>{% csrf_token %}
        <div class="pseudo"><h3>{{ pseudo }}</h3></div>{% csrf_token %}
        <form action="" method="post" id="myForm">{% csrf_token %}</form>

        <script>
            const id_quizz = document.querySelector(".id_quizz")
            const pseudo = document.querySelector(".pseudo")
            let num_question = document.querySelector(".num_question")
            const timerElement = document.querySelector(".timer h2")
            let i =0
            while (true) { //seul moyen que j'ai trouvé pour convertire num_question.innerText en  number pouvant etre incrémenté
                if (num_question.innerText == i) {
                    console.log('ok')
                    break
                }else {
                    console.log('non ok')
                    i++
                }
            }
            let time = timerElement.innerText
            function diminuerTemps() {
                time--
                var str;
                if (time < 0) {
                    str = "http://127.0.0.1:8000/interfaceUser/"+pseudo.innerText+"/id="+id_quizz.innerText+"/num_question="+(i+1)
                    document.location.href = str;
                }
                timerElement.innerText = time

            }


            setInterval(diminuerTemps, 1000)
            let bouton1 = document.querySelector("#bouton1 h2");
            let bouton2 = document.querySelector("#bouton2 h2");
            let bouton3 = document.querySelector("#bouton3 h2");
            let bouton4 = document.querySelector("#bouton4 h2");
            bouton1.addEventListener("mouseenter", function( event ) {
                bouton2.style.opacity = "0.5";
                bouton3.style.opacity = "0.5";
                bouton4.style.opacity = "0.5";
                bouton2.style. transitionDuration = "0.5s"
                bouton3.style. transitionDuration = "0.5s"
                bouton4.style. transitionDuration = "0.5s"
            bouton1.addEventListener("mouseleave", function( event ) {
                bouton2.style.opacity = "1";
                bouton3.style.opacity = "1";
                bouton4.style.opacity = "1";
                bouton2.style. transitionDuration = "0.5s"
                bouton3.style. transitionDuration = "0.5s"
                bouton4.style. transitionDuration = "0.5s"
            });
            }, true);
            bouton2.addEventListener("mouseenter", function( event ) {
                bouton1.style.opacity = "0.5";
                bouton3.style.opacity = "0.5";
                bouton4.style.opacity = "0.5";
                bouton1.style.transitionDuration = "0.5s"
                bouton3.style.transitionDuration = "0.5s"
                bouton4.style.transitionDuration = "0.5s"
            bouton2.addEventListener("mouseleave", function( event ) {
                bouton1.style.opacity = "1";
                bouton3.style.opacity = "1";
                bouton4.style.opacity = "1";
                bouton1.style.transitionDuration = "0.5s"
                bouton3.style.transitionDuration = "0.5s"
                bouton4.style.transitionDuration = "0.5s"
            });
            }, true);
            bouton3.addEventListener("mouseenter", function( event ) {
                bouton1.style.opacity = "0.5";
                bouton2.style.opacity = "0.5";
                bouton4.style.opacity = "0.5";
                bouton1.style.transitionDuration = "0.5s"
                bouton2.style.transitionDuration = "0.5s"
                bouton4.style.transitionDuration = "0.5s"
            bouton3.addEventListener("mouseleave", function( event ) {
               bouton1.style.opacity = "1";
                bouton2.style.opacity = "1";
                bouton4.style.opacity = "1";
                bouton1.style.transitionDuration = "0.5s"
                bouton2.style.transitionDuration = "0.5s"
                bouton4.style.transitionDuration = "0.5s"
            });
            }, true);
           bouton4.addEventListener("mouseenter", function( event ) {
                bouton1.style.opacity = "0.5";
                bouton2.style.opacity = "0.5";
                bouton3.style.opacity = "0.5";
                bouton1.style.transitionDuration = "0.5s"
                bouton2.style.transitionDuration = "0.5s"
                bouton3.style.transitionDuration = "0.5s"
            bouton4.addEventListener("mouseleave", function( event ) {
                bouton1.style.opacity = "1";
                bouton2.style.opacity = "1";
                bouton3.style.opacity = "1";
                bouton1.style.transitionDuration = "0.5s"
                bouton2.style.transitionDuration = "0.5s"
                bouton3.style.transitionDuration = "0.5s"

            });
            }, true);
           //progression bar

        </script>
    </div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
</body>
<footer>
     <div class="barre_progression" style="--duration: {{ timer }};" data-style="smooth">
         <div></div>
</footer>
</html>